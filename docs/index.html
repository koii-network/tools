<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@_koi/sdk</title>
	<meta name="description" content="Documentation for @_koi/sdk">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@_koi/sdk</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>@_koi/sdk</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#koi-javascript-sdk" id="koi-javascript-sdk" style="color: inherit; text-decoration: none;">
					<h1>Koi JavaScript SDK</h1>
				</a>
				<p>The Koi.js library enables node.js and javascript/typescript applications to easily interact with the open Koi network.</p>
				<a href="#steps-to-interact-with-the-sdk-in-your-project" id="steps-to-interact-with-the-sdk-in-your-project" style="color: inherit; text-decoration: none;">
					<h2>Steps to Interact with the SDK in your Project</h2>
				</a>
				<ol>
					<li><p>Add the sdk to your project</p>
						<p>You can use either npm or yarn</p>
						<pre><code><span style="color: #001080">npm</span><span style="color: #000000"> </span><span style="color: #001080">i</span><span style="color: #000000"> @</span><span style="color: #001080">_koi</span><span style="color: #000000">/</span><span style="color: #001080">sdk</span>
<span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">add</span><span style="color: #000000"> @</span><span style="color: #001080">_koi</span><span style="color: #000000">/</span><span style="color: #001080">sdk</span>
</code></pre>
					</li>
					<li><p>Add the Koi-tools module to your script and then initialize the koi class.</p>
						<pre><code><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Web</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;@_koi/sdk/web&quot;</span><span style="color: #000000">;</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ktools</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Web</span><span style="color: #000000">();</span>
</code></pre>
						<p>or with CommonJS</p>
						<pre><code><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">kweb</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;@_koi/sdk/web&quot;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ktools</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">kweb</span><span style="color: #000000">.</span><span style="color: #795E26">Web</span><span style="color: #000000">();</span>
</code></pre>
						<p>or using the bundle</p>
						<pre><code><span style="color: #000000">&lt;</span><span style="color: #001080">script</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;koi_tools.js&quot;</span><span style="color: #000000">&gt;&lt;/</span><span style="color: #267F99">script</span><span style="color: #000000">&gt;</span>
<span style="color: #000000">...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">kweb</span><span style="color: #000000"> = </span><span style="color: #001080">koi_tools</span><span style="color: #000000">.</span><span style="color: #001080">koi_web</span><span style="color: #000000">;</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ktools</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">kweb</span><span style="color: #000000">.</span><span style="color: #795E26">Web</span><span style="color: #000000">();</span>
</code></pre>
					</li>
				</ol>
				<p>Note: This library changes often, so if <code>npm i koi-tools</code> does not work, check for beta releases on NPM under the versions section or manually build the package. See <a href="#Build">#Build</a> section below.</p>
				<ol start="3">
					<li><p>Optional - Add the Arweave module to your project if your app plans to directly transact with the permaweb outside of using the Koi-tools library</p>
						<pre><code><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">Arweave</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;arweave/node&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">arweave</span><span style="color: #000000"> = </span><span style="color: #001080">Arweave</span><span style="color: #000000">.</span><span style="color: #795E26">init</span><span style="color: #000000">({</span>
<span style="color: #000000">  </span><span style="color: #001080">host:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;arweave.net&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">protocol:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;https&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">port:</span><span style="color: #000000"> </span><span style="color: #098658">443</span>
<span style="color: #000000">});</span>
</code></pre>
					</li>
					<li><p>Create an RSA Wallet Key</p>
						<p>Note that the wallet address should not be held inside of your project when you check the project into GitHub</p>
						<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">walletKeyLocation</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;path/to/wallet.json&quot;</span><span style="color: #000000">;</span>
</code></pre>
						<p>If you don&#39;t have a wallet, you can get one from the faucet at <a href="https://koi.rocks/">koi.rocks</a> or the Arweave faucet at <a href="https://faucet.arweave.org/">faucet.arweave.org</a>.</p>
					</li>
					<li><p>Define a function to bootstrap your app and utilize the koi-tools library <code>loadWallet</code> method to be returned the address of your wallet from the permaweb.</p>
						<pre><code><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">start</span><span style="color: #000000">() {</span>

<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;running async block&quot;</span><span style="color: #000000">, </span><span style="color: #001080">ktools</span><span style="color: #000000">)</span>

<span style="color: #000000">  </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">ktools</span><span style="color: #000000">.</span><span style="color: #795E26">loadWallet</span><span style="color: #000000">(</span><span style="color: #001080">walletKeyLocation</span><span style="color: #000000">)</span>

<span style="color: #000000">  </span><span style="color: #AF00DB">try</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// define async functions here that interact with the koi library upon app startup such as verifying signed payloads</span>

<span style="color: #000000">  } </span><span style="color: #AF00DB">catch</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">throw</span><span style="color: #000000"> </span><span style="color: #267F99">Error</span><span style="color: #000000">(</span><span style="color: #001080">err</span><span style="color: #000000">)</span>
<span style="color: #000000">  }</span>

<span style="color: #000000">}</span>

<span style="color: #795E26">start</span><span style="color: #000000">()</span>
</code></pre>
						<p>If you are just testing with a local bundler, you can also use <code>await ktools.generateWallet()</code> to create a custom key file just for that runtime. (TODO: Expand support for 12 word seed phrase).</p>
					</li>
					<li><p>Check out the test.js file held in this library with examples of how to interact with koi-tools.</p>
					</li>
				</ol>
				<a href="#content-rewards" id="content-rewards" style="color: inherit; text-decoration: none;">
					<h2>Content Rewards</h2>
				</a>
				<p>The Koi consensus process releases 1,000 KOI tokens per day to reward the best content that has ever been registered, proportional to the attention it receives in that time period.</p>
				<p>Register arweave content like so:</p>
				<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koiTools</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;koiTools&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">koiTools</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;/path/to/wallet.json&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">burnAmount</span><span style="color: #000000"> = </span><span style="color: #098658">5</span><span style="color: #000000">; </span><span style="color: #008000">// the amount of koi to burn on registration (burn more to earn more!)</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000">.</span><span style="color: #795E26">registerContent</span><span style="color: #000000">(&lt; </span><span style="color: #267F99">arweaveTxId</span><span style="color: #000000"> &gt;, </span><span style="color: #001080">burnAmount</span><span style="color: #000000"> ? </span><span style="color: #001080">optional</span><span style="color: #000000">)</span>
<span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;registered:&#039;</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">)</span>
</code></pre>
				<p>Fetch all registered records:</p>
				<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">records</span><span style="color: #000000"> = </span><span style="color: #001080">koiTools</span><span style="color: #000000">.</span><span style="color: #795E26">retrieveAllRegisteredContent</span><span style="color: #000000">();</span>
</code></pre>
				<p>This will print a full list of all registered NFTs by txID, which can then be fetched using the bundler endpoints of any koii node:</p>
				<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">nftdata</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">fetch</span><span style="color: #000000">(</span><span style="color: #A31515">`https://bundler.openkoi.com:8888/state/getNFTState?tranxId=</span><span style="color: #0000FF">${</span><span style="color: #001080">id</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">)</span>
</code></pre>
				<p>Once this has been completed, your wallet will receive a portion of the daily KOI tokens every time your content is viewed.</p>
				<p>If you do not have a KOI balance, you cannot participate. Your KOI will be burned to register the content.</p>
				<a href="#coming-soon-koi-tasks" id="coming-soon-koi-tasks" style="color: inherit; text-decoration: none;">
					<h2>Coming Soon: KOI Tasks</h2>
				</a>
				<p>In order to ensure everyone has open access to the network, we&#39;re working on making it possible for nodes to run &#39;tasks&#39; for each other to earn tokens.</p>
				<a href="#earning-koi" id="earning-koi" style="color: inherit; text-decoration: none;">
					<h3>Earning KOI</h3>
				</a>
				<p>The default task is will be called StoreCat, which gathers web data and stores it on the permaweb archive. To run StoreCat, you can use a similar implementation to the one above.</p>
				<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koiTools</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;koiTools&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">koiTools</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;/path/to/wallet.json&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000">.</span><span style="color: #795E26">runTaskByRegisteredName</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;getstorecat&#039;</span><span style="color: #000000">)</span>
<span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;task:&#039;</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">)</span>
</code></pre>
				<p>Note: Some tasks take a while to execute, so the best way to run them is with the desktop node client.</p>
				<a href="#requesting-tasks" id="requesting-tasks" style="color: inherit; text-decoration: none;">
					<h3>Requesting Tasks</h3>
				</a>
				<p>It will soon be possible to tap into the Koi network to request work. Once you have KOI tokens, you can set a bounty for a new task.</p>
				<pre><code><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koiTools</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;koiTools&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">koiTools</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;/path/to/wallet.json&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">koiTask</span><span style="color: #000000"> = {</span>
<span style="color: #000000">   </span><span style="color: #001080">id :</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;getstorecat&quot;</span><span style="color: #000000">, </span><span style="color: #008000">// unique global ID *see runTaskByRegisteredName above</span>
<span style="color: #000000">   </span><span style="color: #001080">bounty :</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;5&quot;</span><span style="color: #000000">,       </span><span style="color: #008000">// bounty per result in KOI</span>
<span style="color: #000000">   </span><span style="color: #001080">description :</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;</span>
<span style="color: #A31515">      Help StoreCat gather web data by running this simple web scraping task. The StoreCat does not have access to your computer, but will use your internet connection to browse the web</span><span style="color: #CD3131">.</span>
<span style="color: #000000">   </span><span style="color: #A31515">&quot;, // long form description tex</span><span style="color: #CD3131">t</span>
<span style="color: #000000">   </span><span style="color: #001080">expiry</span><span style="color: #000000"> : </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000"> () + </span><span style="color: #098658">5</span><span style="color: #000000">,       </span><span style="color: #008000">// expiry date after which unspent bounty tokens will be returned</span>
<span style="color: #000000">   </span><span style="color: #001080">taskFile :</span><span style="color: #000000"> </span><span style="color: #A31515">&quot; arweave TX ID of task file&quot;</span><span style="color: #000000"> </span><span style="color: #008000">// the execution environment currently supports most NPM bundles</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">koi</span><span style="color: #000000">.</span><span style="color: #795E26">registerTask</span><span style="color: #000000">(</span><span style="color: #001080">koiTask</span><span style="color: #000000">)</span>
<span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;registered:&#039;</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">)</span>
</code></pre>
				<a href="#build" id="build" style="color: inherit; text-decoration: none;">
					<h2>Build</h2>
				</a>
				<a href="#npm" id="npm" style="color: inherit; text-decoration: none;">
					<h3>NPM</h3>
				</a>
				<pre><code><span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">install</span>
<span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">build</span>
<span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">publish</span><span style="color: #000000"> </span><span style="color: #001080">dist</span>
</code></pre>
				<p>For beta releases</p>
				<ul>
					<li>append <code>-beta.N</code> to <code>dist/package.json</code> version where N is the beta version</li>
					<li>use <code>yarn publish dist --tag beta</code></li>
				</ul>
				<a href="#webpack" id="webpack" style="color: inherit; text-decoration: none;">
					<h3>Webpack</h3>
				</a>
				<pre><code><span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">install</span>
<span style="color: #001080">yarn</span><span style="color: #000000"> </span><span style="color: #001080">bundle</span>
</code></pre>
				<p>Test with <code>yarn test</code></p>
				<a href="#useful-vscode-settings" id="useful-vscode-settings" style="color: inherit; text-decoration: none;">
					<h3>Useful vscode settings</h3>
				</a>
				<p><code>settings.json</code></p>
				<pre><code><span style="color: #000000">    </span><span style="color: #A31515">&quot;eslint.validate&quot;</span><span style="color: #000000">: [</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;typescript&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;typescriptreact&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    ],</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;editor.codeActionsOnSave&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;source.fixAll.eslint&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span>
<span style="color: #000000">    }</span>
</code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/common.html">common</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/node.html">node</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/web.html">web</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>